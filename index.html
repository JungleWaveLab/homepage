<!DOCTYPE html>
<html lang="ko" class="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>파충류 사육 통합 대시보드 - Jungle Wave</title>
    <meta name="description" content="비바리움 관리부터 커뮤니티까지. 정글웨이브 앱으로 스마트하게 파충류를 관리하세요.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://junglewave-app.web.app/">
    <meta property="og:title" content="Jungle Wave - 파충류 통합 관리">
    <meta property="og:description" content="내 손안의 작은 정글. 비바리움 관리, 커뮤니티, 그리고 쇼핑까지.">
    <meta property="og:image" content="https://via.placeholder.com/1200x630/0c1f15/3e8457?text=Jungle+Wave+App">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://webfontworld.github.io/TheJamsil/TheJamsil.css" rel="stylesheet">

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        jungle: {
                            50: '#f2f7f4', 100: '#e1ede4', 200: '#c3dcc9', 300: '#96c2a5',
                            400: '#64a37b', 500: '#3e8457', 600: '#2d6a43', 700: '#255436',
                            800: '#1e432d', 900: '#1A3020', 950: '#0c1f15',
                        },
                        sand: { DEFAULT: '#F5F5DC' }
                    }
                }
            }
        }
    </script>
    <style>
        /* 글로벌 폰트 강제 적용 */
        * { font-family: 'TheJamsil', sans-serif !important; }
        body { transition: background-color 0.3s, color 0.3s; letter-spacing: -0.01em; }
        
        /* 스크롤바 디자인 */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #d4d4d8; border-radius: 4px; }
        .dark ::-webkit-scrollbar-thumb { background: #3f3f46; }

        .animate-fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>

<body class="min-h-screen flex flex-col font-sans antialiased bg-gray-50 text-gray-900 dark:bg-black dark:text-gray-100 transition-colors duration-300">

    <button onclick="toggleMobileMenu()" class="md:hidden fixed top-4 left-4 z-50 bg-black text-white p-2 rounded-full shadow-lg">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
        </svg>
    </button>

    <aside id="sidebar" class="fixed inset-y-0 left-0 w-64 bg-white dark:bg-black border-r border-gray-100 dark:border-zinc-800 transform -translate-x-full md:translate-x-0 transition-transform duration-300 z-40 overflow-y-auto">
        <div class="h-20 flex items-center px-8 border-b border-gray-100 dark:border-zinc-800">
            <div class="cursor-pointer group" onclick="adminClickCounter()">
                <h1 class="text-xl font-bold tracking-tighter text-black dark:text-white group-hover:text-jungle-600 transition-colors">JUNGLE WAVE</h1>
                <div class="text-[9px] uppercase tracking-[0.3em] text-gray-400">Bio Lab System</div>
            </div>
        </div>

        <nav class="p-6 space-y-2">
            <button onclick="switchTab('home')" id="nav-home" class="w-full text-left flex items-center gap-4 px-4 py-3 text-xs font-bold uppercase tracking-widest text-black dark:text-white hover:bg-gray-50 dark:hover:bg-zinc-900 rounded-lg transition-colors border-l-2 border-transparent hover:border-black dark:hover:border-white">HOME</button>
            <button onclick="switchTab('process')" id="nav-process" class="w-full text-left flex items-center gap-4 px-4 py-3 text-xs font-bold uppercase tracking-widest text-gray-500 hover:text-black dark:hover:text-white hover:bg-gray-50 dark:hover:bg-zinc-900 rounded-lg transition-colors border-l-2 border-transparent hover:border-black dark:hover:border-white">PROCESS</button>

            <div class="pt-4 pb-2">
                <button onclick="toggleLabMenu()" class="w-full text-left flex items-center justify-between px-4 py-2 text-[10px] font-bold uppercase tracking-[0.2em] text-gray-400 hover:text-jungle-600 transition-colors">
                    <span>JUNGLE LAB</span>
                    <svg id="lab-arrow" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-3 h-3 transform transition-transform duration-300">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                    </svg>
                </button>
                <div id="lab-menu" class="space-y-1 mt-2 overflow-hidden transition-all duration-300 max-h-0">
                    <button onclick="switchTab('encyclopedia')" id="nav-encyclopedia" class="w-full text-left pl-8 py-3 text-xs text-gray-500 hover:text-black dark:hover:text-white hover:bg-gray-50 dark:hover:bg-zinc-900 rounded-lg transition-colors block">ARCHIVE</button>
                    <button onclick="switchTab('calculator')" id="nav-calculator" class="w-full text-left pl-8 py-3 text-xs text-gray-500 hover:text-black dark:hover:text-white hover:bg-gray-50 dark:hover:bg-zinc-900 rounded-lg transition-colors block">SOLUTION</button>
                    <button onclick="switchTab('diary')" id="nav-diary" class="w-full text-left pl-8 py-3 text-xs text-gray-500 hover:text-black dark:hover:text-white hover:bg-gray-50 dark:hover:bg-zinc-900 rounded-lg transition-colors block">MANAGER</button>
                </div>
            </div>

            <button onclick="switchTab('shop')" id="nav-shop" class="w-full text-left flex items-center gap-4 px-4 py-3 text-xs font-bold uppercase tracking-widest text-gray-500 hover:text-black dark:hover:text-white hover:bg-gray-50 dark:hover:bg-zinc-900 rounded-lg transition-colors border-l-2 border-transparent hover:border-black dark:hover:border-white">STORE</button>
            <button onclick="switchTab('community')" id="nav-community" class="w-full text-left flex items-center gap-4 px-4 py-3 text-xs font-bold uppercase tracking-widest text-gray-500 hover:text-black dark:hover:text-white hover:bg-gray-50 dark:hover:bg-zinc-900 rounded-lg transition-colors border-l-2 border-transparent hover:border-black dark:hover:border-white">COMMUNITY</button>

            <div class="pt-8 border-t border-gray-100 dark:border-zinc-800 mt-8">
                <button onclick="switchTab('rank')" id="nav-rank" class="w-full text-left px-4 py-2 text-[10px] uppercase text-gray-400 hover:text-black dark:hover:text-white transition-colors">Rank System</button>
                <button onclick="switchTab('admin')" id="nav-admin" class="hidden w-full text-left px-4 py-2 text-[10px] uppercase text-gray-400 hover:text-black dark:hover:text-white transition-colors">Admin Access</button>
                <button onclick="toggleTheme()" class="w-full text-left px-4 py-2 text-[10px] uppercase text-gray-400 hover:text-black dark:hover:text-white transition-colors">Topic: Light/Dark</button>
            </div>
        </nav>
        <div class="absolute bottom-0 w-full p-8 text-[9px] text-gray-300 leading-relaxed">© 2024 JUNGLE WAVE<br>Seoul, Gangnam-gu</div>
    </aside>
    <div id="sidebar-overlay" onclick="toggleMobileMenu()" class="fixed inset-0 bg-black/50 z-30 hidden md:hidden backdrop-blur-sm transition-opacity"></div>

    <main class="md:ml-64 transition-all duration-300 flex-grow max-w-[1440px] mx-auto px-4 py-6 w-full">

        <section id="content-home" class="section-tab animate-fade-in w-full">
            <div class="relative h-screen max-h-[900px] w-full overflow-hidden">
                <img src="assets/hero.png" class="absolute inset-0 w-full h-full object-cover">
                <div class="absolute inset-0 bg-black/40 flex flex-col items-center justify-center text-center p-6">
                    <div class="inline-flex items-center gap-2 px-5 py-2.5 border border-white/20 bg-black/30 backdrop-blur-md rounded-full mb-8 shadow-xl">
                        <span class="w-2 h-2 rounded-full bg-green-400 animate-pulse"></span>
                        <span class="text-xs font-bold text-sand tracking-widest uppercase">700+ Crested Gecko Care Data</span>
                    </div>
                    <h1 class="text-5xl md:text-8xl font-bold text-white mb-6 tracking-tighter drop-shadow-2xl">JUNGLE WAVE</h1>
                    <p class="text-xl md:text-2xl text-gray-200 font-light tracking-[0.1em] mb-12 drop-shadow-lg break-keep">자연의 생명력을 일상으로 가져오는 바이오필릭 디자인 스튜디오</p>
                    <div class="flex flex-col sm:flex-row gap-4">
                        <button onclick="switchTab('process')" class="bg-white/10 hover:bg-white text-white hover:text-black border border-white/50 backdrop-blur-md px-12 py-4 font-bold tracking-[0.2em] uppercase transition-all">Explore</button>
                        <button onclick="switchTab('shop')" class="bg-jungle-600 hover:bg-jungle-500 text-white border border-jungle-500 shadow-lg px-12 py-4 font-bold tracking-[0.2em] uppercase transition-all">Premium Shop</button>
                    </div>
                </div>
            </div>
            <div class="max-w-7xl mx-auto px-6 py-24 bg-white dark:bg-black">
                <div class="text-center mb-16">
                    <h2 class="text-3xl font-bold text-black dark:text-white uppercase tracking-tight mb-2">Deep Dive Projects</h2>
                    <div class="w-12 h-1 bg-black dark:bg-white mx-auto"></div>
                </div>
                <div id="portfolioGrid" class="grid grid-cols-1 md:grid-cols-3 gap-1"></div>
            </div>
            <div class="bg-gray-100 dark:bg-zinc-900 py-20 px-6 text-center w-full">
                <div class="max-w-4xl mx-auto">
                    <h2 class="text-3xl font-bold text-black dark:text-white uppercase tracking-tight mb-4">Premium Shop</h2>
                    <p class="text-gray-600 dark:text-gray-400 mb-8 max-w-xl mx-auto break-keep">전문가의 수작업으로 완성되는 마스터피스 비바리움을 만나보세요.</p>
                    <button onclick="switchTab('shop')" class="bg-jungle-600 hover:bg-jungle-500 text-white font-bold py-4 px-10 rounded-full transition-colors tracking-widest uppercase text-sm shadow-md">스토어 입장하기</button>
                </div>
            </div>
        </section>

        <section id="content-process" class="section-tab hidden animate-fade-in w-full max-w-[1440px] mx-auto px-6 py-20">
            <div class="text-center mb-24">
                <h2 class="text-5xl font-bold text-black dark:text-white uppercase tracking-tighter mb-6">The Process</h2>
                <p class="text-gray-400 max-w-xl mx-auto tracking-wide">JUNGLE WAVE VIVARIUM SYSTEM</p>
            </div>
            <div class="space-y-32">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-16 items-center">
                    <div class="h-[600px] bg-gray-100 dark:bg-zinc-900 overflow-hidden relative group"><img src="assets/process1.png" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"></div>
                    <div><span class="text-xs font-bold text-jungle-600 uppercase tracking-widest mb-2 block">Step 01</span><h3 class="text-4xl font-bold text-black dark:text-white mb-6">상담 및 생물 선정</h3><p class="text-gray-600 dark:text-gray-400 text-lg">사육 환경과 사용자의 니즈를 분석하여 제안합니다.</p></div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-16 items-center flex-row-reverse">
                    <div class="order-2 md:order-1"><span class="text-xs font-bold text-jungle-600 uppercase tracking-widest mb-2 block">Step 02</span><h3 class="text-4xl font-bold text-black dark:text-white mb-6">레이아웃 설계</h3><p class="text-gray-600 dark:text-gray-400 text-lg">프리미엄 유목과 수석으로 생태계 구조를 디자인합니다.</p></div>
                    <div class="h-[600px] bg-gray-100 dark:bg-zinc-900 overflow-hidden relative group order-1 md:order-2"><img src="assets/process2.png" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"></div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-16 items-center">
                    <div class="h-[600px] bg-gray-100 dark:bg-zinc-900 overflow-hidden relative group"><img src="assets/process3.png" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"></div>
                    <div><span class="text-xs font-bold text-jungle-600 uppercase tracking-widest mb-2 block">Step 03</span><h3 class="text-4xl font-bold text-black dark:text-white mb-6">식재 및 안착</h3><p class="text-gray-600 dark:text-gray-400 text-lg">적합한 식물과 습도 순환 시스템을 구축합니다.</p></div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-16 items-center flex-row-reverse">
                    <div class="order-2 md:order-1"><span class="text-xs font-bold text-jungle-600 uppercase tracking-widest mb-2 block">Step 04</span><h3 class="text-4xl font-bold text-black dark:text-white mb-6">안전 배송 및 관리</h3><p class="text-gray-600 dark:text-gray-400 text-lg">작은 생태계를 안전하게 전달하고 가이드를 제공합니다.</p></div>
                    <div class="h-[600px] bg-gray-100 dark:bg-zinc-900 overflow-hidden relative group order-1 md:order-2"><img src="assets/process4.png" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"></div>
                </div>
            </div>
        </section>

        <section id="content-encyclopedia" class="section-tab hidden space-y-6 animate-fade-in max-w-4xl mx-auto px-6 py-8">
            <div class="relative">
                <input type="text" id="searchInput" placeholder="데이터베이스 검색 (예: 크레스티드 게코)" class="w-full bg-white dark:bg-zinc-900 border border-gray-300 dark:border-zinc-700 rounded-lg py-3 px-4 pl-10 focus:border-jungle-500 outline-none" onkeyup="filterSpecies()">
            </div>
            <div id="speciesGrid" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
            <div id="noResults" class="hidden text-center py-10 text-gray-500">일치하는 데이터가 없습니다.</div>
        </section>

        <section id="content-calculator" class="section-tab hidden space-y-8 animate-fade-in max-w-4xl mx-auto px-6 py-8">
            <div class="bg-white dark:bg-zinc-900 rounded-lg p-6 border border-gray-200 dark:border-zinc-800 shadow-lg">
                <h2 class="text-xl font-bold mb-4">SUBSTRATE SOLUTION</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                    <input type="number" id="calcW" class="border p-3 rounded dark:bg-black dark:border-zinc-700 w-full" placeholder="가로 (cm)">
                    <input type="number" id="calcD" class="border p-3 rounded dark:bg-black dark:border-zinc-700 w-full" placeholder="세로 (cm)">
                    <input type="number" id="calcH" class="border p-3 rounded dark:bg-black dark:border-zinc-700 w-full" placeholder="바닥재 높이 (cm)">
                </div>
                <button onclick="calculateSoil()" class="w-full bg-jungle-600 text-white font-bold py-4 rounded-lg">SOLVE</button>
            </div>
            <div id="calcResult" class="hidden text-center p-8 bg-jungle-50 dark:bg-zinc-900 rounded-lg border shadow-lg">
                <div class="text-gray-500 mb-2">필요 용량 (여유분 10% 포함)</div>
                <div class="text-5xl font-bold text-jungle-700 dark:text-white mb-6"><span id="resultLiters">0.0</span> L</div>
                <div id="recommendationText" class="font-bold text-lg text-gray-800 dark:text-gray-200"></div>
            </div>
        </section>

        <section id="content-diary" class="section-tab hidden space-y-6 animate-fade-in max-w-4xl mx-auto px-6 py-8">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-xl font-bold" id="currentMonthLabel"></h2>
                <div class="space-x-1">
                    <button onclick="changeMonth(-1)" class="p-2 border rounded">◀</button>
                    <button onclick="todayMonth()" class="px-3 py-2 bg-jungle-600 text-white rounded font-bold text-xs">TODAY</button>
                    <button onclick="changeMonth(1)" class="p-2 border rounded">▶</button>
                </div>
            </div>
            <div class="grid grid-cols-7 gap-2 text-center text-xs font-bold text-gray-500 mb-2">
                <div class="text-red-500">Sun</div><div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div class="text-blue-500">Sat</div>
            </div>
            <div id="calendarGrid" class="grid grid-cols-7 gap-2 mb-8"></div>
        </section>

        <section id="content-community" class="section-tab hidden space-y-6 animate-fade-in max-w-4xl mx-auto px-6 py-8">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold">COMMUNITY</h2>
                <button onclick="openWriteModalUI()" class="bg-jungle-600 text-white px-4 py-2 rounded-lg font-bold text-sm">WRITE</button>
            </div>
            <div id="marketing_feed_active" class="space-y-4">
                <div class="text-center py-10 text-gray-400">데이터를 불러오는 중입니다...</div>
            </div>
        </section>

        <section id="content-shop" class="section-tab hidden space-y-8 animate-fade-in max-w-[1440px] mx-auto px-6 py-8">
            <div class="max-w-[1440px] mx-auto">
                <h3 class="text-3xl font-bold text-center mb-4">Bio-Active Vivariums</h3>
                <div class="max-w-md mx-auto pb-10">
                    <div class="group bg-white dark:bg-zinc-900 rounded-lg overflow-hidden border border-gray-100 dark:border-zinc-800 cursor-pointer shadow-lg" onclick="openProductDetail('Standard Edition', 450000, 'standard')">
                        <div class="h-80 overflow-hidden relative">
                            <img src="assets/Light.png" onerror="this.src='https://source.unsplash.com/random/800x1000/?terrarium,jungle'" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-1000">
                            <div class="absolute top-0 right-0 bg-jungle-600 text-white text-[12px] font-bold px-5 py-2 rounded-bl-xl">STANDARD</div>
                        </div>
                        <div class="p-8">
                            <h4 class="text-3xl font-bold mb-4" style="font-family: 'TheJamsil';">Standard Edition</h4>
                            <p class="text-gray-500 mb-8 break-keep" style="font-family: 'TheJamsil';">크레스티드 게코가 가장 편안함을 느끼는 환경을 구현한 황금 규격</p>
                            <div class="text-2xl font-bold mb-6" style="font-family: 'TheJamsil';">450,000<span class="text-base font-normal ml-1">원~</span></div>
                            <button class="w-full py-4 bg-jungle-600 text-white rounded-lg font-bold tracking-widest" style="font-family: 'TheJamsil';">나만의 정글 커스텀하기</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="content-product-detail" class="section-tab hidden animate-fade-in max-w-[1440px] mx-auto px-6 py-8">
            <button onclick="switchTab('shop')" class="flex items-center text-sm font-bold text-gray-500 hover:text-black dark:hover:text-white mb-6 transition-colors">
                ← STORE로 돌아가기
            </button>
            <div class="flex flex-col lg:flex-row gap-12 mt-6">
                <div class="w-full lg:w-3/5">
                    <div class="relative w-full aspect-[4/5] bg-gray-50 dark:bg-zinc-900 rounded-lg overflow-hidden border shadow-inner">
                        <img id="detailBaseImage" src="assets/base Layer.png" class="absolute inset-0 w-full h-full object-cover z-0 transition-opacity duration-500">
                        <img id="layerMossImg" src="assets/Overlay 1.png" class="absolute inset-0 w-full h-full object-cover opacity-0 transition-opacity duration-500 z-10 pointer-events-none">
                        <img id="layerPlantsImg" src="assets/Overlay 2.png" class="absolute inset-0 w-full h-full object-cover opacity-0 transition-opacity duration-500 z-20 pointer-events-none">
                        <img id="layerLightImg" src="assets/조명.png" class="absolute inset-0 w-full h-full object-cover opacity-0 transition-opacity duration-500 z-30 pointer-events-none">
                    </div>
                    <p class="text-sm text-gray-400 mt-6 text-center" style="font-family: 'TheJamsil';">※ 투명 레이어 중첩 효과로 연출된 시뮬레이터입니다.</p>
                </div>
                
                <div class="w-full lg:w-2/5 flex flex-col space-y-6">
                    <div class="border-b border-gray-200 dark:border-zinc-800 pb-6">
                        <span class="bg-gray-100 dark:bg-zinc-800 text-gray-600 dark:text-gray-300 text-[11px] font-bold px-3 py-1.5 rounded tracking-wide mb-4 inline-block font-['TheJamsil']">Bio-Active Vivariums</span>
                        <h2 id="detailTitle" class="text-4xl font-bold mb-4 font-['TheJamsil']">Standard Edition</h2>
                    </div>

                    <div class="space-y-3">
                        <span class="text-xs font-bold text-gray-400 uppercase tracking-widest font-['TheJamsil']">1. 베이스 시스템 선택 (필수)</span>
                        
                        <label class="flex items-center p-4 border border-gray-200 dark:border-zinc-700 rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors">
                            <input type="radio" name="baseSystem" value="1" onchange="updateProductState()" checked class="w-5 h-5 text-jungle-600 focus:ring-jungle-500 border-gray-300">
                            <span class="ml-4 font-bold flex-1 text-sm font-['TheJamsil']">하드 스케이핑 (조형만)</span>
                            <span class="text-gray-600 dark:text-gray-400 font-bold text-sm font-['TheJamsil']">450,000원</span>
                        </label>

                        <label class="flex items-center p-4 border border-gray-200 dark:border-zinc-700 rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors">
                            <input type="radio" name="baseSystem" value="2" onchange="updateProductState()" class="w-5 h-5 text-jungle-600 focus:ring-jungle-500 border-gray-300">
                            <span class="ml-4 font-bold flex-1 text-sm font-['TheJamsil']">하드 스케이핑 + 이끼 식재</span>
                            <span class="text-gray-600 dark:text-gray-400 font-bold text-sm font-['TheJamsil']">480,000원</span>
                        </label>

                        <label class="flex items-center p-4 border border-gray-200 dark:border-zinc-700 rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors">
                            <input type="radio" name="baseSystem" value="3" onchange="updateProductState()" class="w-5 h-5 text-jungle-600 focus:ring-jungle-500 border-gray-300">
                            <div class="ml-4 flex-1">
                                <span class="font-bold block text-sm font-['TheJamsil']">하드 스케이핑 + 배수층 제작</span>
                                <span class="text-xs text-jungle-600 font-['TheJamsil']">프리미엄 배합토 포함</span>
                            </div>
                            <span class="text-gray-600 dark:text-gray-400 font-bold text-sm font-['TheJamsil']">550,000원</span>
                        </label>

                        <label class="flex items-center p-4 border border-gray-200 dark:border-zinc-700 rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors">
                            <input type="radio" name="baseSystem" value="4" onchange="updateProductState()" class="w-5 h-5 text-jungle-600 focus:ring-jungle-500 border-gray-300">
                            <span class="ml-4 font-bold flex-1 text-sm font-['TheJamsil']">하드스케이핑 + 이끼 + 배수층</span>
                            <span class="text-gray-600 dark:text-gray-400 font-bold text-sm font-['TheJamsil']">580,000원</span>
                        </label>
                    </div>

                    <div class="space-y-3 mt-6">
                        <span class="text-xs font-bold text-gray-400 uppercase tracking-widest font-['TheJamsil']">2. 추가 옵션 (선택)</span>
                        
                        <label id="plantOptionContainer" class="flex items-center p-4 border border-gray-200 dark:border-zinc-700 rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors opacity-50 bg-gray-100 dark:bg-zinc-800">
                            <input id="optPlants" type="checkbox" onchange="handlePlantOptionClick(event)" class="w-5 h-5 text-jungle-600 rounded focus:ring-jungle-500 border-gray-300">
                            <div class="ml-4 flex-1">
                                <span class="font-bold block text-sm font-['TheJamsil']">식물 식재</span>
                                <span class="text-xs text-red-500 font-['TheJamsil']">* 배수층 시스템 필수</span>
                            </div>
                            <span class="text-gray-600 dark:text-gray-400 font-bold text-sm font-['TheJamsil']">+ 50,000원</span>
                        </label>

                        <label class="flex items-center p-4 border border-gray-200 dark:border-zinc-700 rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors">
                            <input id="optLight" type="checkbox" onchange="updateProductState()" class="w-5 h-5 text-jungle-600 rounded focus:ring-jungle-500 border-gray-300">
                            <div class="ml-4 flex-1">
                                <span class="font-bold block text-sm font-['TheJamsil']">전용 슬림 LED 조명</span>
                                <span class="text-xs text-gray-400 font-['TheJamsil']">식물 생장용 파장</span>
                            </div>
                            <span class="text-gray-600 dark:text-gray-400 font-bold text-sm font-['TheJamsil']">+ 50,000원</span>
                        </label>
                    </div>

                    <div class="bg-gray-50 dark:bg-zinc-900 p-6 rounded-lg border border-gray-200 dark:border-zinc-800 mt-8">
                        <span class="text-xs font-bold text-jungle-600 dark:text-jungle-400 tracking-widest font-['TheJamsil']">Total Price</span>
                        <div class="text-4xl font-bold font-['TheJamsil'] mt-1"><span id="detailTotalPrice">450,000</span>원</div>
                        <button onclick="openOrderModal()" class="w-full mt-6 bg-black dark:bg-white text-white dark:text-black font-bold py-4 rounded-lg font-['TheJamsil'] tracking-widest hover:bg-gray-800 transition-colors shadow-lg">주문하기</button>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="content-rank" class="section-tab hidden p-8"><h2 class="text-xl font-bold">RANK SYSTEM</h2><div id="user-ui"></div><div id="login-ui"><button onclick="window.googleLogin()">Login</button></div></section>
        <section id="content-admin" class="section-tab hidden p-8"><h2 class="text-xl font-bold text-red-600">ADMIN ONLY</h2></section>

    </main>

    <div id="portfolioModal" class="fixed inset-0 z-[100] hidden items-center justify-center p-4 bg-black/90 backdrop-blur-sm" onclick="closePortfolio()"></div>
    <div id="orderModal" class="hidden fixed inset-0 z-50 items-center justify-center p-4 bg-black/60 backdrop-blur-sm">
        <div class="bg-white p-6 rounded-lg w-full max-w-md">
            <h3 class="font-bold text-xl mb-4 font-['TheJamsil']">주문 상담 신청</h3>
            <div class="bg-gray-50 p-4 rounded-lg mb-4">
                <h4 class="font-bold text-sm mb-2">선택한 옵션 내역</h4>
                <ul id="modalOrderOptions" class="text-xs text-gray-600 space-y-1 mb-3"></ul>
                <div class="border-t pt-2 flex justify-between font-bold">
                    <span>총 예상 금액</span>
                    <span id="modalOrderPrice" class="text-jungle-600"></span>
                </div>
            </div>
            <button onclick="closeOrderModal()" class="w-full bg-black text-white py-3 rounded mt-2 font-['TheJamsil'] tracking-widest">닫기</button>
        </div>
    </div>
    <div id="feedModal" class="hidden fixed inset-0 z-50 items-center justify-center p-4 bg-black/60 backdrop-blur-sm"><div class="bg-white p-6 rounded-lg w-full max-w-md"><h3 id="modalDateTitle" class="font-bold text-xl mb-4">날짜</h3><div id="checkboxContainer"></div><button onclick="closeModal()" class="w-full bg-black text-white py-3 rounded mt-4">저장 및 닫기</button></div></div>
    <div id="speciesModal" class="hidden fixed inset-0 z-50 items-center justify-center p-4 bg-black/60 backdrop-blur-sm"><div class="bg-white p-6 rounded-lg w-full max-w-md"><h3 id="detailName" class="font-bold text-xl mb-4">이름</h3><button onclick="document.getElementById('speciesModal').classList.add('hidden')" class="w-full bg-black text-white py-3 rounded mt-4">닫기</button></div></div>

    <script>
        // 전역 상태 변수
        const State = {
            currentTab: 'home',
            viewDate: new Date(),
            selectedDateStr: '',
            currentUser: null
        };

        const tabs = ['home', 'process', 'encyclopedia', 'calculator', 'diary', 'community', 'shop', 'rank', 'admin', 'product-detail'];

        // 라우팅 및 뒤로가기 로직
        window.addEventListener('popstate', (e) => {
            if (e.state && e.state.tab) {
                switchTabCore(e.state.tab, false);
            } else {
                switchTabCore('home', false);
            }
        });

        // 탭 이동 메인 함수
        window.switchTab = function(tabName) {
            switchTabCore(tabName, true);
        };

        function switchTabCore(tabName, updateHistory) {
            State.currentTab = tabName;

            // 1. 모든 섹션 숨기기
            document.querySelectorAll('.section-tab').forEach(sec => sec.classList.add('hidden'));
            
            // 2. 타겟 섹션 띄우기
            const target = document.getElementById('content-' + tabName);
            if (target) {
                target.classList.remove('hidden');
                void target.offsetWidth; // 리플로우
                target.classList.add('animate-fade-in');
            }

            // 3. 네비 스타일 적용
            tabs.forEach(t => {
                const nav = document.getElementById('nav-' + t);
                if (nav) {
                    if (t === tabName) {
                        nav.classList.add('text-black', 'dark:text-white', 'border-black', 'dark:border-white', 'bg-gray-50');
                        nav.classList.remove('text-gray-500', 'border-transparent');
                    } else {
                        nav.classList.remove('text-black', 'dark:text-white', 'border-black', 'dark:border-white', 'bg-gray-50');
                        nav.classList.add('text-gray-500', 'border-transparent');
                    }
                }
            });

            // 4. URL 업데이트
            if (updateHistory) {
                history.pushState({ tab: tabName }, '', '#' + tabName);
            }

            // 5. 상품 페이지를 나갈 때 잔상(옵션) 완벽하게 초기화
            if (tabName !== 'product-detail') {
                const baseRadio1 = document.querySelector('input[name="baseSystem"][value="1"]');
                if(baseRadio1) {
                    baseRadio1.checked = true;
                    updateProductState();
                }
            }

            window.scrollTo(0, 0);
        }

        // 초기 로딩 시 URL 해시 확인
        window.onload = () => {
            const hash = window.location.hash.replace('#', '');
            if (hash && tabs.includes(hash)) {
                switchTabCore(hash, false);
            } else {
                switchTabCore('home', false);
            }
            if(window.renderCalendar) window.renderCalendar();
            
            if (localStorage.getItem('theme') === 'dark') {
                document.documentElement.classList.add('dark');
            }
        };

        // --- 여기서부터 스토어 상품 시뮬레이터 핵심 로직 ---
        window.openProductDetail = function(title, price, typeId) {
            // 진입 시 라디오 1번 강제 선택
            const baseSystem1 = document.querySelector('input[name="baseSystem"][value="1"]');
            if(baseSystem1) baseSystem1.checked = true;
            
            const optPlants = document.getElementById('optPlants');
            if(optPlants) optPlants.checked = false;
            
            const optLight = document.getElementById('optLight');
            if(optLight) optLight.checked = false;
            
            updateProductState();
            switchTab('product-detail');
        };

        // 식물 체크박스 눌렀을 때 배수층 확인하는 로직
        window.handlePlantOptionClick = function(e) {
            const baseLevel = parseInt(document.querySelector('input[name="baseSystem"]:checked').value);
            
            if (baseLevel === 1 || baseLevel === 2) {
                e.preventDefault(); 
                document.getElementById('optPlants').checked = false;
                alert("식물을 식재하기 위해서는 배수층 시스템이 포함된 옵션(3번 또는 4번)을 먼저 선택하셔야 합니다.");
                return;
            }
            updateProductState();
        };

        // 금액 및 이미지 렌더링
        window.updateProductState = function() {
            const radioEl = document.querySelector('input[name="baseSystem"]:checked');
            if(!radioEl) return;
            
            const baseLevel = parseInt(radioEl.value);
            const optPlants = document.getElementById('optPlants').checked;
            const optLight = document.getElementById('optLight').checked;

            let total = 0;
            let baseImgSrc = "assets/base Layer.png";
            let showMoss = false;

            // 1~4번 시스템 판별
            if (baseLevel === 1) {
                total += 450000;
                baseImgSrc = "assets/base Layer.png";
                showMoss = false;
            } else if (baseLevel === 2) {
                total += 480000;
                baseImgSrc = "assets/base Layer.png";
                showMoss = true;
            } else if (baseLevel === 3) {
                total += 550000;
                baseImgSrc = "assets/base Layer_substrate.png";
                showMoss = false;
            } else if (baseLevel === 4) {
                total += 580000;
                baseImgSrc = "assets/base Layer_substrate.png";
                showMoss = true;
            }

            if (optPlants) total += 50000;
            if (optLight) total += 50000;

            // 식물 옵션 UI 비활성화 연출
            const plantContainer = document.getElementById('plantOptionContainer');
            if (plantContainer) {
                if (baseLevel === 1 || baseLevel === 2) {
                    plantContainer.classList.add('opacity-50', 'bg-gray-100', 'dark:bg-zinc-800');
                    if(optPlants) document.getElementById('optPlants').checked = false; 
                } else {
                    plantContainer.classList.remove('opacity-50', 'bg-gray-100', 'dark:bg-zinc-800');
                }
            }

            // 이미지 변경
            const detailBase = document.getElementById('detailBaseImage');
            if(detailBase) detailBase.src = baseImgSrc;
            
            const mossImg = document.getElementById('layerMossImg');
            if(mossImg) mossImg.style.opacity = showMoss ? '1' : '0';
            
            const plantsImg = document.getElementById('layerPlantsImg');
            if(plantsImg) plantsImg.style.opacity = optPlants ? '1' : '0';
            
            const lightImg = document.getElementById('layerLightImg');
            if(lightImg) lightImg.style.opacity = optLight ? '1' : '0';

            // 가격 표시
            const formattedTotal = new Intl.NumberFormat('ko-KR').format(total);
            const detailTotal = document.getElementById('detailTotalPrice');
            if(detailTotal) detailTotal.innerText = formattedTotal;
        };

        // 주문 모달 열기 (선택된 옵션 리스트 띄우기)
        window.openOrderModal = () => {
            const modal = document.getElementById('orderModal');
            if (modal) {
                const baseLevel = parseInt(document.querySelector('input[name="baseSystem"]:checked').value);
                const optPlants = document.getElementById('optPlants').checked;
                const optLight = document.getElementById('optLight').checked;
                
                const selectedOptions = [];
                if (baseLevel === 1) selectedOptions.push('하드 스케이핑 (조형만)');
                if (baseLevel === 2) selectedOptions.push('하드 스케이핑 + 이끼 식재');
                if (baseLevel === 3) selectedOptions.push('하드 스케이핑 + 배수층 제작');
                if (baseLevel === 4) selectedOptions.push('하드스케이핑 + 이끼 + 배수층');
                
                if (optPlants) selectedOptions.push('식물 식재 (+50,000원)');
                if (optLight) selectedOptions.push('전용 슬림 LED 조명 (+50,000원)');

                document.getElementById('modalOrderPrice').innerText = document.getElementById('detailTotalPrice').innerText + '원';
                document.getElementById('modalOrderOptions').innerHTML = selectedOptions.map(opt => `<li>- ${opt}</li>`).join('');

                modal.classList.remove('hidden');
            }
        };

        window.closeOrderModal = () => document.getElementById('orderModal').classList.add('hidden');

        // 기타 모달 제어 함수들
        window.toggleMobileMenu = () => {
            const sb = document.getElementById('sidebar');
            sb.classList.toggle('-translate-x-full');
            document.getElementById('sidebar-overlay').classList.toggle('hidden');
        };
        window.toggleLabMenu = () => {
            const menu = document.getElementById('lab-menu');
            menu.style.maxHeight = menu.style.maxHeight ? null : menu.scrollHeight + "px";
        };
        window.closePortfolio = () => document.getElementById('portfolioModal').classList.add('hidden');
        window.closeModal = () => document.getElementById('feedModal').classList.add('hidden');
        
        let adminClicks = 0;
        window.adminClickCounter = () => {
            adminClicks++;
            if(adminClicks >= 5) { switchTab('admin'); adminClicks = 0; }
            setTimeout(() => adminClicks = 0, 3000);
        };
    </script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        import { getFirestore, collection, query, orderBy, limit, onSnapshot } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDc5hBqdfxvTnQg-qU1FMKU76f2sjx_f6w",
            authDomain: "junglewave-app.firebaseapp.com",
            projectId: "junglewave-app",
            storageBucket: "junglewave-app.firebasestorage.app",
            messagingSenderId: "666614908112",
            appId: "1:666614908112:web:84577cea28150dfe964ad5"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        window.db = db;

        // 로그인 감지
        onAuthStateChanged(auth, (user) => {
            if (user) {
                State.currentUser = user;
                if(document.getElementById('login-ui')) document.getElementById('login-ui').classList.add('hidden');
                if(document.getElementById('user-ui')) document.getElementById('user-ui').classList.remove('hidden');
            } else {
                State.currentUser = null;
            }
        });

        window.googleLogin = () => signInWithPopup(auth, new GoogleAuthProvider());
        
        // 커뮤니티 데이터 리스너
        const q = query(collection(db, "posts"), orderBy("createdAt", "desc"), limit(20));
        onSnapshot(q, (snap) => {
            const list = document.getElementById('marketing_feed_active');
            if (!list) return;
            if (snap.empty) {
                list.innerHTML = '<div class="text-center py-10 text-gray-400">데이터를 불러오는 중입니다.</div>';
            } else {
                list.innerHTML = "";
                snap.forEach(doc => {
                    const d = doc.data();
                    list.innerHTML += `<div class="bg-white p-5 rounded-lg border shadow-sm mb-4"><h3 class="font-bold">${d.title}</h3><p class="text-sm text-gray-600 mt-2">${d.content}</p></div>`;
                });
            }
        });
    </script>
</body>
</html>